<!DOCTYPE HTML>
<!--
Arcana by HTML5 UP
html5up.net | @ajlkn
Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>

<head>
<!-- <title>Arcana by HTML5 UP</title> -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
<link rel="stylesheet" href="../assets/css/main.css" />
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script> MathJax = { tex: {
      tags: 'all'  // should be 'ams', 'none', or 'all'
    }
  };</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
  
<body class="is-preload">
<div id="page-wrapper">

<!-- Header -->
<div id="header">

<!-- Logo -->
<h1><a href="index.html" id="logo">DeepDrill<em> Mandelbrot</em></a></h1>

<!-- Nav -->
<nav id="nav">
<ul>
<li><a href="../index.html">Home</a></li>
<li class="current"><a href="index.html">Documentation</a></li>
<li><a href="https://github.com/dirkwhoffmann/DeepDrill">Code</a></li>
<li><a href="https://github.com/dirkwhoffmann/DeepDrill/issues">Issues</a></li>
<li><a href="https://github.com/dirkwhoffmann/DeepDrill/discussions">Discussions</a></li>
<li><a href="../impressum.html">Impressum</a></li>
</ul>
</nav>
</div>

<!-- Main -->
<section class="wrapper style1">
<div class="container">
<div class="row gtr-200">
<div class="col-9 col-12-narrower imp-narrower">
<div id="content">

<!-- Content -->

<article>

<h2>Perturbation Theory</h2>

<p>The idea of perturbation is to start with the orbit of a reference point, the so called <em>reference orbit</em>, and to express the orbits of all other points in form of deviations to it. More precisely, let 

$$(x_n) = x_0, x_1, x_2, \ldots \label{eq:reforbit} $$

be the orbit of the reference point \(x \in \mathbb{C}\) and \( y \) be a point in the neighborhood of \( x \). Then we can calculate the orbit of \( y \) in the following form:

$$(y_n) = x_0 + \Delta_0, x_1 + \Delta_1, x_2 + \Delta_2, \ldots \nonumber $$

The sequence 

$$(\Delta_n) = \Delta_0, \Delta_1, \Delta_2, \ldots  \label{eq:deltorb} $$

is called the <em>delta orbit</em> of \( y \). Once the reference orbit \eqref{eq:reforbit} has been calculated, it is sufficient to know the delta orbit \( (\Delta_n) \) to fully reconstruct \( (y_n) \).</p>

<p>Delta orbits can be computed with a simple iteration formula that can be derived directly from the iteration formula of the Mandelbrot set:
$$
\begin{align}
\Delta_0 &= y_0 - x_0 \nonumber \\
\Delta_{n+1} &= y_{n+1} - x_{n+1} \nonumber \\
&= (y_n^2 + y_0) - (x_n^2 + x_0) \nonumber \\
&= (y_n^2 - x_n^2) + (y_0 - x_0)  \nonumber \\
&= ((x_n + \Delta_n)^2 - x_n^2) + \Delta_0 \nonumber \\
&= 2 x_n \Delta_n + \Delta_n^2 + \Delta_0 \label{eq:delta}
\end{align}
$$
<p>Equation \eqref{eq:delta} shows that the deltas can be calculated with a sum whose summands are all very small. In fact, the numbers are so small that it is usually sufficient to represent them with low-precision data types. This outlines the core of the algorithm: Instead of slowly calculating all points in high precision, an expensive calculation of this kind is carried out for a single reference point, only. All other orbits are derived from their delta orbits which are calculated in low precision.</p>

<p>Unfortunately, the outlined approach does not always succeed. A general problem concerns the choice of the reference point \( x \). If the orbit of \( x \) escapes, i.e., if \( x \) does not belong to the Mandelbrot set itself, equation (\ref{eq:delta}) can only be applied to the elements of the non-escaping initial segment of \( (x_n) \). As a result, \( x \) cannot serve as the reference for any other point \( y \) that either belongs to the Mandelbrot set itself, or diverges later than \( x \). Even worse, delta calculation can fail  with non-volatile reference points, too. In some cases, rounding errors lead to visible pixel errors in the generated image. Such pixels are referred to as <em>glitches</em>. If a pixel is a glitch, there is an increased probability that this is also true for its neighbors. As a result, affected image often contain areas that look extremely noisy or areas that have no detail at all, thus looking like ill-placed color blobs.</p>

<p>Fortunately, both problems can be solved by recomputing the affected pixels with a different reference point. Modern Mandelbrot generators thus calculate images in multiple rounds. In each round a new reference point is selected and applied to all pixels for which it turns out to be appropriate. If a glitch a detected, the pixel is set aside and revisited in the next round. This procedure is repeated until the proportion of glitch pixels drops below a predefined acceptance level.</p>

<p>Besides choosing a suitable reference point, we face a challenging problem. How can we decide for a point whether the currently selected reference point results in a glitch? An answer to this question is provided by the <em>Pauldelbrot criterion</em>, which was formulated in a <a href="http://www.fractalforums.com/announcements-and-news/pertubation-theory-glitches-improvement/msg73027/#msg73027">forum post</a> in 2014. The criterion is based on the hypothesis that pixel errors only occur if the magnitude of \( x_n + \Delta_n \) is way smaller than the magnitude of \( x_n \). Symbolically, this is is denoted by:

$$| x_n + \Delta_n | << | x_n | \nonumber $$

To apply the criterion in practice, a constant \( \tau \) is chosen and a test added to the delta orbit calculation, which checks the following condition after each iteration:

$$ | x_n + \Delta_n | < \tau \cdot | x_n | $$

Once the condition hits, calculation is aborted. The affected point is put aside and revisited in the next round. Although the criterion is based on a hypothesis that is still lacking a rigid proof (as far as I know), it has turned out to work extremely well in practice. As of today, the Pauldelbrot criterion is the preferred method for glitch detection in modern Mandelbrot generators.</p>

<p><a href="series.html">Continue reading</a></p>
</article>
</div>
</div>
<div class="col-3 col-12-narrower">
<div id="sidebar2">

<!-- Sidebar -->
<section>
<h3>Getting Started</h3>
<ul>
	<li><a href="installation.html">Building DeepDrill</a></li>
	<li><a href="tutorial.html">Running DeepDrill</a></li>
</ul>

<h3>Theory</h3>
<ul>
	<li><a href="mandel.html">The Mandelbrot Set</a></li>
	<li><a href="perturb.html">Perturbation Theory</a></li>
	<li><a href="series.html">Series Approximation</a></li>
</ul>
</section>
</div>
</div>
</div>
</div>
</section>

<!-- Footer -->
<div id="footer">

<!-- Icons -->
<ul class="icons">
<li><a href="https://github.com/dirkwhoffmann" class="icon brands fa-github"><span
class="label">GitHub</span></a></li>
</ul>

<!-- Copyright -->
<div class="copyright">
<ul class="menu">
<li>&copy; <a href="http://www.dirkwhoffmann.de">Dirk W. Hoffmann</a></li>
<li><a href="impressum.html">Impressum</a></li>
<li><a href="impressum.html">Datenschutz</a></li>
<li><a href="http://html5up.net">HTML5 UP</a></li>
</ul>
</div>

</div>

</div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.dropotron.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
</body>

</html>